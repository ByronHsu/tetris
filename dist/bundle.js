!function(r){function t(o){if(e[o])return e[o].exports;var f=e[o]={i:o,l:!1,exports:{}};return r[o].call(f.exports,f,f.exports,t),f.l=!0,f.exports}var e={};t.m=r,t.c=e,t.i=function(r){return r},t.d=function(r,e,o){t.o(r,e)||Object.defineProperty(r,e,{configurable:!1,enumerable:!0,get:o})},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},t.p="",t(t.s=1)}([function(r,t,e){"use strict";function o(){for(var r=0;r<20;r++)for(var t=0;t<12;t++)R[r][t]=0}function f(){r:for(var r=0;r<20;r++){for(var t=[],e=0;e<20;e++)for(var f=0;f<12;f++)_[e][f]=0;if(!R[r][0]&&O[r][0]){var i={x:0,y:r},l=O[r][0];for(t.push(i);0!=t.length;){var u=t[0];R[u.y][u.x]=1,_[u.y][u.x]=1,t.shift();for(var v=0;v<4;v++){var s=u.x+C[v],c=u.y+S[v];if(s>=0&&s<12&&c>=0&&c<20&&O[c][s]===l&&!R[c][s]){var h={x:s,y:c};t.push(h)}}}for(var y=0;y<20;y++)if(1===_[y][11]){for(var d=0;d<=11;d++)for(var x=0;x<=19;x++)1===_[x][d]&&(P++,O[x][d]=0);for(var g=0;g<20;g++)for(var m=0;m<12;m++)_[g][m]=0,R[g][m]=0;for(var p=0,k=19;k>=0;k--){for(var b=0;b<12;b++){for(var M=0;M<20;M++)for(var w=0;w<12;w++)_[M][w]=0;if(!R[k][b]&&0!=O[k][b]){var E=O[k][b],I=[],j={y:k,x:b};for(I.push(j);0!=I.length;){var A=I[0];R[A.y][A.x]=1,_[A.y][A.x]=O[A.y][A.x],I.shift();for(var B=0;B<4;B++){var D=A.x+C[B],F=A.y+S[B];if(D>=0&&D<12&&F>=0&&F<20&&O[F][D]===E&&!R[F][D]){var L={x:D,y:F};I.push(L)}}}var T=n();0!=T&&(p=T),a()}}0!==k||0==p||(p=0)}o();continue r}}}}function n(){for(var r=1e4,t=_.map(function(r){return r.slice()}),e=0;e<12;e++){for(var o=1e4,f=0,n=19;n>=0;n--)if(0!=_[n][e]){for(var a=n+1;a<=20;a++){if(20===a){o=a-n-1,f=1;break}if(0!=O[a][e]){o=a-n-1,f=1;break}}if(f)break}r=Math.min(r,o)}for(var i=0;i<r;i++)_.splice(19,1),_.unshift([0,0,0,0,0,0,0,0,0,0,0,0]);for(var l=0;l<20;l++)for(var u=0;u<12;u++)0!=t[l][u]&&(O[l][u]=0,R[l][u]=0);for(var v=0;v<20;v++)for(var s=0;s<12;s++)0!=_[v][s]&&(O[v][s]=_[v][s],R[v][s]=1);return r}function a(){document.getElementById("score").innerHTML=""+10*P,k.fillStyle="#202028",k.fillRect(0,0,24,40);for(var r=0;r<O.length;r++)for(var t=0;t<O[r].length;t++)0!=O[r][t]&&(k.beginPath(),k.lineWidth="0.1",k.strokeStyle="black",k.rect(t,r,1,1),k.stroke(),k.fillStyle=b[O[r][t]],k.fillRect(t,r,1,1))}function i(r){for(var t=r.matrix,e=0;e<t.length;e++)for(var o=0;o<t[e].length;o++)0!=t[e][o]&&(k.beginPath(),k.lineWidth="0.1",k.strokeStyle="black",k.rect(o+r.offset.x,e+r.offset.y,1,1),k.stroke(),k.fillStyle=b[t[e][o]],k.fillRect(o+r.offset.x,e+r.offset.y,1,1))}function l(){for(;;)if(E.offset.y++,s(O,E)){if(E.offset.y--,s(O,E))return void(w=1);y(O,E),o(),f(),x();break}I=0}function u(){if(E.offset.y++,s(O,E)){if(E.offset.y--,s(O,E))return void(w=1);y(O,E),o(),f(),x()}I=0}function v(r){E.offset.x+=r,s(O,E)&&(E.offset.x-=r)}function s(r,t){for(var e=t.matrix,o=t.offset,f=0;f<e.length;++f)for(var n=0;n<e[f].length;++n)if(0!==e[f][n]&&0!==(r[f+o.y]&&r[f+o.y][n+o.x]))return!0;return!1}function c(r){var t=E.offset.x,e=1;for(h(r,E);s(O,E);)if(E.offset.x+=e,(e=-(e+(e>0?1:-1)))>E.matrix[0].length)return h(-r,E),void(E.offset.x=t);for(t=E.offset.y,e=1;s(O,E);)if(E.offset.y+=e,(e=-(e+(e>0?1:-1)))>E.matrix[0].length)return h(-r,E),void(E.offset.y=t)}function h(r,t){for(var e=t.matrix,o=e.map(function(r){return r.slice()}),f=0;f<e.length;f++)for(var n=0;n<e[f].length;n++)o[n][f]=e[f][n];if(1===r)for(var a=0;a<e.length;a++)for(var i=0;i<Math.floor(e[a].length/2);i++){var l=[o[a][e[a].length-i-1],o[a][i]];o[a][i]=l[0],o[a][e[a].length-i-1]=l[1]}else for(var u=0;u<Math.floor(e.length/2);u++)for(var v=0;v<e[u].length;v++){var s=[o[e.length-u-1][v],o[u][v]];o[u][v]=s[0],o[e.length-u-1][v]=s[1]}t.matrix=o}function y(r,t){for(var e=t.matrix,o=0;o<e.length;o++)for(var f=0;f<e[o].length;f++)0!=e[o][f]&&(r[o+t.offset.y][f+t.offset.x]=e[o][f])}function d(){w=0,I=0,P=0;for(var r=0;r<20;r++)for(var t=0;t<12;t++)O[r][t]=0,R[r][t]=0,_[r][t]=0;x(),g()}function x(){E={type:Math.floor(7*Math.random())},E.matrix=M[E.type];for(var r=0;r<E.matrix.length;r++)for(var t=0;t<E.matrix.length;t++)0!=E.matrix[r][t]&&(E.matrix[r][t]=Math.floor(2*Math.random()+1));var e=11-E.matrix.length;E.offset={x:Math.floor(Math.random()*e),y:0}}function g(){I++,40==I&&(u(),I=0),1!==w&&(a(),i(E),window.requestAnimationFrame(g))}function m(){for(var r=0;r<20;r++){O.push([]),R.push([]),_.push([]);for(var t=0;t<12;t++)O[r].push(0),R[r].push(0),_[r].push(0)}}Object.defineProperty(t,"__esModule",{value:!0});var p=document.getElementById("tetris"),k=p.getContext("2d"),b=[null,"#F27557","#84E9D8","#DAFD79"],M=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[1,1],[1,1]],[[0,0,0],[1,1,1],[0,1,0]],[[1,0,0],[1,1,1],[0,0,0]],[[0,0,1],[1,1,1],[0,0,0]],[[0,1,1],[1,1,0],[0,0,0]],[[1,1,0],[0,1,1],[0,0,0]]],C=[1,0,-1,0],S=[0,1,0,-1];document.addEventListener("keydown",function(r){39===r.keyCode?v(1):37===r.keyCode?v(-1):40===r.keyCode?u():69===r.keyCode?c(1):81===r.keyCode?c(-1):32===r.keyCode&&l()});var w=void 0,E=void 0,I=void 0,P=void 0,O=[],R=[],_=[];t.gameInit=m,t.gameStart=d},function(r,t,e){"use strict";function o(){a.fillStyle="black",a.fillRect(0,0,24,40),a.font="0.8px Arial",a.fillStyle="white",a.fillText("press enter to continue...",1.6,10)}var f=e(0),n=document.getElementById("tetris"),a=n.getContext("2d");a.scale(20,20),o(),(0,f.gameInit)();var i=0;document.addEventListener("keydown",function(r){13!==r.keyCode||i||(i=1,(0,f.gameStart)(),o(),i=0)})}]);