!function(r){function t(o){if(e[o])return e[o].exports;var f=e[o]={i:o,l:!1,exports:{}};return r[o].call(f.exports,f,f.exports,t),f.l=!0,f.exports}var e={};t.m=r,t.c=e,t.i=function(r){return r},t.d=function(r,e,o){t.o(r,e)||Object.defineProperty(r,e,{configurable:!1,enumerable:!0,get:o})},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},t.p="",t(t.s=1)}([function(r,t,e){"use strict";function o(){for(var r=0;r<20;r++)for(var t=0;t<12;t++)O[r][t]=0}function f(){r:for(var r=0;r<20;r++){for(var t=[],e=0;e<20;e++)for(var f=0;f<12;f++)R[e][f]=0;if(!O[r][0]&&I[r][0]){var i={x:0,y:r},l=I[r][0];for(t.push(i);0!=t.length;){var u=t[0];O[u.y][u.x]=1,R[u.y][u.x]=1,t.shift();for(var v=0;v<4;v++){var s=u.x+S[v],c=u.y+C[v];if(s>=0&&s<12&&c>=0&&c<20&&I[c][s]===l&&!O[c][s]){var h={x:s,y:c};t.push(h)}}}for(var y=0;y<20;y++)if(1===R[y][11]){for(var x=0;x<=11;x++)for(var d=0;d<=19;d++)1===R[d][x]&&(I[d][x]=0);for(var g=0;g<20;g++)for(var m=0;m<12;m++)R[g][m]=0,O[g][m]=0;for(var p=19;p>=0;p--)for(var k=0,b=0;b<24;k=(k+1)%12,b++){for(var M=0;M<20;M++)for(var w=0;w<12;w++)R[M][w]=0;if(!O[p][k]&&0!=I[p][k]){var E=I[p][k],P=[],_={y:p,x:k};for(P.push(_);0!=P.length;){var j=P[0];O[j.y][j.x]=1,R[j.y][j.x]=I[j.y][j.x],P.shift();for(var A=0;A<4;A++){var D=j.x+S[A],F=j.y+C[A];if(D>=0&&D<12&&F>=0&&F<20&&I[F][D]===E&&!O[F][D]){var B={x:D,y:F};P.push(B)}}}n(),a()}}o();continue r}}}}function n(){for(var r=1e4,t=R.map(function(r){return r.slice()}),e=0;e<12;e++){for(var o=1e4,f=0,n=19;n>=0;n--)if(0!=R[n][e]){for(var a=n+1;a<=20;a++){if(20===a){o=a-n-1,f=1;break}if(0!=I[a][e]){o=a-n-1,f=1;break}}if(f)break}r=Math.min(r,o)}for(var i=0;i<r;i++)R.splice(19,1),R.unshift([0,0,0,0,0,0,0,0,0,0,0,0]);for(var l=0;l<20;l++)for(var u=0;u<12;u++)0!=t[l][u]&&(I[l][u]=0,O[l][u]=0);for(var v=0;v<20;v++)for(var s=0;s<12;s++)0!=R[v][s]&&(I[v][s]=R[v][s],O[v][s]=1)}function a(){k.fillStyle="#202028",k.fillRect(0,0,24,40);for(var r=0;r<I.length;r++)for(var t=0;t<I[r].length;t++)0!=I[r][t]&&(k.beginPath(),k.lineWidth="0.1",k.strokeStyle="black",k.rect(t,r,1,1),k.stroke(),k.fillStyle=b[I[r][t]],k.fillRect(t,r,1,1))}function i(r){for(var t=r.matrix,e=0;e<t.length;e++)for(var o=0;o<t[e].length;o++)0!=t[e][o]&&(k.beginPath(),k.lineWidth="0.1",k.strokeStyle="black",k.rect(o+r.offset.x,e+r.offset.y,1,1),k.stroke(),k.fillStyle=b[t[e][o]],k.fillRect(o+r.offset.x,e+r.offset.y,1,1))}function l(){for(;;)if(E.offset.y++,s(I,E)){if(E.offset.y--,s(I,E))return void(w=1);y(I,E),o(),f(),d();break}P=0}function u(){if(E.offset.y++,s(I,E)){if(E.offset.y--,s(I,E))return void(w=1);y(I,E),o(),f(),d()}P=0}function v(r){E.offset.x+=r,s(I,E)&&(E.offset.x-=r)}function s(r,t){for(var e=t.matrix,o=t.offset,f=0;f<e.length;++f)for(var n=0;n<e[f].length;++n)if(0!==e[f][n]&&0!==(r[f+o.y]&&r[f+o.y][n+o.x]))return!0;return!1}function c(r){var t=E.offset.x,e=1;for(h(r,E);s(I,E);)if(E.offset.x+=e,(e=-(e+(e>0?1:-1)))>E.matrix[0].length)return h(-r,E),void(E.offset.x=t);for(t=E.offset.y,e=1;s(I,E);)if(E.offset.y+=e,(e=-(e+(e>0?1:-1)))>E.matrix[0].length)return h(-r,E),void(E.offset.y=t)}function h(r,t){for(var e=t.matrix,o=e.map(function(r){return r.slice()}),f=0;f<e.length;f++)for(var n=0;n<e[f].length;n++)o[n][f]=e[f][n];if(1===r)for(var a=0;a<e.length;a++)for(var i=0;i<Math.floor(e[a].length/2);i++){var l=[o[a][e[a].length-i-1],o[a][i]];o[a][i]=l[0],o[a][e[a].length-i-1]=l[1]}else for(var u=0;u<Math.floor(e.length/2);u++)for(var v=0;v<e[u].length;v++){var s=[o[e.length-u-1][v],o[u][v]];o[u][v]=s[0],o[e.length-u-1][v]=s[1]}t.matrix=o}function y(r,t){for(var e=t.matrix,o=0;o<e.length;o++)for(var f=0;f<e[o].length;f++)0!=e[o][f]&&(r[o+t.offset.y][f+t.offset.x]=e[o][f])}function x(){w=0,P=0;for(var r=0;r<20;r++)for(var t=0;t<12;t++)I[r][t]=0,O[r][t]=0,R[r][t]=0;d(),g()}function d(){E={type:Math.floor(7*Math.random())},E.matrix=M[E.type];for(var r=0;r<E.matrix.length;r++)for(var t=0;t<E.matrix.length;t++)0!=E.matrix[r][t]&&(E.matrix[r][t]=Math.floor(2*Math.random()+1));var e=11-E.matrix.length;E.offset={x:Math.floor(Math.random()*e),y:0}}function g(){P++,40==P&&(u(),P=0),1!==w&&(a(),i(E),window.requestAnimationFrame(g))}function m(){for(var r=0;r<20;r++){I.push([]),O.push([]),R.push([]);for(var t=0;t<12;t++)I[r].push(0),O[r].push(0),R[r].push(0)}}Object.defineProperty(t,"__esModule",{value:!0});var p=document.getElementById("tetris"),k=p.getContext("2d"),b=[null,"#F27557","#84E9D8","#DAFD79"],M=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[1,1],[1,1]],[[0,0,0],[1,1,1],[0,1,0]],[[1,0,0],[1,1,1],[0,0,0]],[[0,0,1],[1,1,1],[0,0,0]],[[0,1,1],[1,1,0],[0,0,0]],[[1,1,0],[0,1,1],[0,0,0]]],S=[1,0,-1,0],C=[0,1,0,-1];document.addEventListener("keydown",function(r){39===r.keyCode?v(1):37===r.keyCode?v(-1):40===r.keyCode?u():69===r.keyCode?c(1):81===r.keyCode?c(-1):32===r.keyCode&&l()});var w=void 0,E=void 0,P=void 0,I=[],O=[],R=[];t.gameInit=m,t.gameStart=x},function(r,t,e){"use strict";function o(){a.fillStyle="black",a.fillRect(0,0,24,40),a.font="0.8px Arial",a.fillStyle="white",a.fillText("press enter to continue...",1.6,10)}var f=e(0),n=document.getElementById("tetris"),a=n.getContext("2d");a.scale(20,20),console.log(f.gameStart),o(),(0,f.gameInit)();var i=0;document.addEventListener("keydown",function(r){13!==r.keyCode||i||(i=1,(0,f.gameStart)(),o(),i=0)})}]);